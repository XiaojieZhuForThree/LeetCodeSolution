package com.leetcode.problems;

import java.util.ArrayDeque;
import java.util.Deque;

public class Question316 {
	class Solution {
		public String removeDuplicateLetters(String s) {
			int[] counts = new int[26];
			boolean[] contains = new boolean[26];
			Deque<Character> stack = new ArrayDeque<>();
			StringBuilder sb = new StringBuilder();

			for (char c : s.toCharArray()) {
				counts[c - 'a']++;
			}

			for (char c : s.toCharArray()) {
				counts[c - 'a']--;
				if (contains[c - 'a']) {
					continue;
				}
				while (!stack.isEmpty() && stack.peekLast() > c && counts[stack.peekLast() - 'a'] > 0) {
					contains[stack.peekLast() - 'a'] = false;
					stack.pollLast();
				}
				stack.offer(c);
				contains[c - 'a'] = true;
			}

			for (char c : stack) {
				sb.append(c);
			}

			return sb.toString();
		}
	}
}
