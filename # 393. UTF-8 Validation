class Solution {
    
    public boolean validUtf8(int[] data) {
        for (int i = 0; i < data.length; i++) {
            int len = len(data[i]);
            if (len < 0) continue;
            if (len == 0 || len >= 4) return false;
            if (i + len >= data.length) return false;
            for (int j = i + 1; j <= i + len; j++) {
                if (((data[j] >> 7) & 1) != 1 || ((data[j] >> 6) & 1) != 0) return false;
            }
            i = i + len;
        }
        return true;
    }
    
    private int len(int data) {
        int bitIndex = 7;
        while (bitIndex >= 0 && ((data >> bitIndex) & 1) != 0) {
            bitIndex--;
        }
        return 7 - bitIndex - 1;
    }
    
}
