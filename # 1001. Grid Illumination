package com.leetcode.problems;

import java.util.HashMap;
import java.util.Map;

public class Question1001 {
	class Solution {
		public int[] gridIllumination(int N, int[][] lamps, int[][] queries) {
			Map<Integer, Integer> row = new HashMap<>();
			Map<Integer, Integer> col = new HashMap<>();
			Map<Integer, Integer> upper = new HashMap<>();
			Map<Integer, Integer> lower = new HashMap<>();
			Map<Integer, Boolean> lightOn = new HashMap<>();
			int[][] dirs = new int[][] { { 0, 0 }, { 0, 1 }, { 0, -1 }, { 1, 0 }, { -1, 0 }, { 1, 1 }, { 1, -1 },
					{ -1, 1 }, { -1, -1 } };
			int[] ans = new int[queries.length];
			for (int[] lamp : lamps) {
				int x = lamp[0], y = lamp[1];
				row.put(x, row.getOrDefault(x, 0) + 1);
				col.put(y, col.getOrDefault(y, 0) + 1);
				upper.put(x + y, upper.getOrDefault(x + y, 0) + 1);
				lower.put(x - y, lower.getOrDefault(x - y, 0) + 1);
				lightOn.put(x * N + y, true);
			}
			for (int i = 0; i < queries.length; i++) {
				int[] query = queries[i];
				int x = query[0], y = query[1];
				if (row.getOrDefault(x, 0) > 0 || col.getOrDefault(y, 0) > 0 || upper.getOrDefault(x + y, 0) > 0
						|| lower.getOrDefault(x - y, 0) > 0) {
					ans[i] = 1;
				} else {
					ans[i] = 0;
				}
				for (int[] dir : dirs) {
					int nx = x + dir[0], ny = y + dir[1];
					if (nx < 0 || nx >= N || ny < 0 || ny >= N) {
						continue;
					}
					if (!lightOn.containsKey(nx * N + ny) || !lightOn.get(nx * N + ny)) {
						continue;
					}
					lightOn.put(nx * N + ny, false);
					row.put(nx, row.getOrDefault(x, 1) - 1);
					col.put(ny, col.getOrDefault(ny, 1) - 1);
					upper.put(nx + ny, upper.getOrDefault(nx + ny, 1) - 1);
					lower.put(nx - ny, lower.getOrDefault(nx - ny, 1) - 1);
				}
			}
			return ans;
		}
	}
}
