package com.leetcode.problems;

import java.util.ArrayDeque;
import java.util.Deque;
import java.util.HashMap;
import java.util.Map;

public class Question895 {
	class FreqStack {
		Map<Integer, Deque<Integer>> stackMap;
		Map<Integer, Integer> freqs;
		int mostFreq;

		public FreqStack() {
			stackMap = new HashMap<>();
			freqs = new HashMap<>();
			mostFreq = 0;
		}

		public void push(int x) {
			freqs.put(x, freqs.getOrDefault(x, 0) + 1);
			int freq = freqs.get(x);
			stackMap.putIfAbsent(freq, new ArrayDeque<>());
			stackMap.get(freq).offerLast(x);
			if (freq > mostFreq) {
				mostFreq = freq;
			}
		}

		public int pop() {
			int val = stackMap.get(mostFreq).pollLast();
			if (stackMap.get(mostFreq).isEmpty()) {
				mostFreq--;
			}
			freqs.put(val, freqs.get(val) - 1);
			return val;
		}
	}

	/**
	 * Your FreqStack object will be instantiated and called as such: FreqStack obj
	 * = new FreqStack(); obj.push(x); int param_2 = obj.pop();
	 */
}
